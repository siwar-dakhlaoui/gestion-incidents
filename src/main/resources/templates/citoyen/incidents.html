<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Mes incidents</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-4">

    <h3 class="mb-4">üìã Mes incidents d√©clar√©s</h3>

    <!-- AUCUN INCIDENT -->
    <div th:if="${#lists.isEmpty(incidents)}"
         class="alert alert-info text-center">
        Aucun incident d√©clar√©.
    </div>

    <!-- TABLE INCIDENTS -->
    <div th:if="${!#lists.isEmpty(incidents)}" class="table-responsive">

        <table class="table table-bordered table-hover align-middle">

            <thead class="table-dark text-center">
            <tr>
                <th>#</th>
                <th>Titre</th>
                <th>Cat√©gorie</th>
                <th>Statut</th>
                <th>Date d√©claration</th>
                <th>Photos</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="incident, i : ${incidents}">
                <td th:text="${i.count}" class="text-center"></td>

                <td th:text="${incident.titre}"></td>

                <td class="text-center">
                    <span class="badge bg-secondary"
                          th:text="${incident.categorie}"></span>
                </td>

                <td class="text-center">
                    <span class="badge bg-info"
                          th:text="${incident.statut}"></span>
                </td>

                <td class="text-center"
                    th:text="${#temporals.format(incident.dateDeclaration, 'dd/MM/yyyy')}">
                </td>

                <td>
                    <div th:if="${incident.photos == null or #lists.isEmpty(incident.photos)}">
                        <span class="text-muted">Aucune photo</span>
                    </div>

                    <div th:each="photo : ${incident.photos}">
                        <a th:href="@{/uploads/incidents/{img}(img=${photo})}" target="_blank">
                            <img th:src="@{/uploads/incidents/{img}(img=${photo})}"
                                 style="width:80px;height:80px;object-fit:cover;border-radius:6px;margin:2px"/>
                        </a>
                    </div>
                </td>




            </tr>
            </tbody>

        </table>
    </div>

    <!-- ACTIONS -->
    <div class="mt-4">
        <a th:href="@{/citoyen/dashboard}" class="btn btn-secondary">
            ‚¨Ö Retour au dashboard
        </a>

        <a th:href="@{/citoyen/declarer}" class="btn btn-success ms-2">
            ‚ûï D√©clarer un nouvel incident
        </a>
    </div>

</div>

</body>
</html>
